<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <fastCgi>
      <!-- When fullPath is
           `%SystemDrive%\Python27\Scripts\iiswsgi.exe` a console
           windows opens when the app starts and responses don't get
           sent to the browser.  Hence we use `python.exe -u
           *-script.py`. -->
      <!-- Can't use environment variables in monitorChangesTo -->
      <!-- XXX getting an error on first page load but works fine on
           refresh and thereafter -->
      <application
          fullPath="{APPL_PHYSICAL_PATH}\Scripts\python.exe"
          arguments="-u &quot;{APPL_PHYSICAL_PATH}\{{INSTANCE_HOME}}\bin\iiswsgi-script.py&quot; -vv -c &quot;{APPL_PHYSICAL_PATH}\{{INSTANCE_HOME}}\{{WSGI_CONFIG}}&quot;"
          monitorChangesTo="{APPL_PHYSICAL_PATH}\{{INSTANCE_HOME}}\{{WSGI_CONFIG}}"
          maxInstances="__webpi_clients_parameter__"
          activityTimeout="600" requestTimeout="600" idleTimeout="604800" />
    </fastCgi>
    <security>
      <requestFiltering allowDoubleEscaping="true">
        <!-- allow ++namespace++ URLs -->
      </requestFiltering>
    </security>
    <handlers>
      <add name="plone.app"
	   scriptProcessor="{APPL_PHYSICAL_PATH}\Scripts\python.exe|-u &quot;{APPL_PHYSICAL_PATH}\{{INSTANCE_HOME}}\bin\iiswsgi-script.py&quot; -vv -c &quot;{APPL_PHYSICAL_PATH}\{{INSTANCE_HOME}}\{{WSGI_CONFIG}}&quot;"
	   path="*" verb="*"
	   modules="FastCgiModule"/>
    </handlers>
  </system.webServer>
</configuration>
